# backup-with-rsync

`backup_list.csv` ファイルで指定された複数のディレクトリを、`rsync` を使って効率的にバックアップするシェルスクリプトです。
Linux環境および、WSL (Windows Subsystem for Linux) や Git Bash を導入したWindows環境で動作します。

## 主な機能

- **設定ファイルベース**: `backup_list.csv` にバックアップしたい内容を記述するだけで、複数のバックアップを一括で実行できます。
- **差分バックアップ**: `rsync` を利用しているため、変更があったファイルのみを転送する高速な差分バックアップが可能です。
- **柔軟な削除オプション**: バックアップ元で削除されたファイルを、バックアップ先からも削除するかどうか（ミラーリングするかどうか）を設定ごとに選択できます。
- **移動モード**: バックアップ完了後に、元のファイルを削除する「移動モード」をサポートします。

## 使い方

1. **設定ファイルの準備**

   `backup_list.csv.sample` ファイルをコピーして、`backup_list.csv` という名前のファイルを作成します。

   ```bash
   cp backup_list.csv.sample backup_list.csv
   ```

2. **バックアップ設定の編集**

   `backup_list.csv` を開き、バックアップしたいディレクトリの情報を記述します。ファイルの書式は以下の通りです。

   ```csv
   # バックアップ元,バックアップ先,削除オプション,移動オプション
   ```

   - **バックアップ元**: バックアップしたいフォルダの絶対パス。
   - **バックアップ先**: バックアップを保存したいフォルダの絶対パス。
   - **削除オプション** (`true`/`false`):
     - `true`: バックアップ元にないファイルをバックアップ先から削除します（同期）。
     - `false` (または空欄): バックアップ先のファイルは削除しません（追加）。
   - **移動オプション** (`true`/`false`):
     - `true`: バックアップ成功後、バックアップ元のファイルを削除します。
     - `false` (または空欄): バックアップ元のファイルは保持されます。

   ### !!! 警告: 移動オプションについて !!!

   **移動オプションを `true` に設定すると、`rsync` による転送が成功したファイルはバックアップ元から完全に削除されます。** これは、ファイルの「移動」に相当する破壊的な操作です。意図しないデータ損失を防ぐため、このオプションは十分に理解した上で、慎重に使用してください。

   **設定例:**
   ```csv
   # Documentsフォルダを外付けHDDに同期する（元ファイルは保持）
   /home/user/Documents,/media/user/backup_hdd/Documents,true,false

   # Downloadsフォルダの中身をアーカイブ用ディスクに移動する（元ファイルは削除）
   /home/user/Downloads,/mnt/archive/Downloads,true,true
   ```

3. **バックアップの実行**

   以下のコマンドを実行して、バックアップを開始します。

   ```bash
   ./backup.sh
   ```

   スクリプトは `backup_list.csv` の内容を上から順に実行します。

## 今後の開発予定

- [ ] ログ機能の追加
- [ ] エラーハンドリングの強化
- [ ] dry-run（テスト実行）オプションの追加
- [ ] バックアップ対象除外リストのサポート
